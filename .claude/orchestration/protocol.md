# エージェント協調プロトコル

> ⚠️ **重要**: Claude Codeが厳格に遵守すべき必須の動作仕様です

## 基本ルール

### Primary Agent（あなた）
**実装は行わず、Sub Agentに実装指示のみを出す**

**あなたはPrimary Agentとして以下を遵守してください：**

1. **タスク受付と分析**
    - ユーザー要求の分析と要件定義
    - タスクの分解と優先順位付け

2. **Sub Agentへの実装指示**
    - 適切なSub Agentを選定
    - 必要なコンテキスト情報を準備
    - 明確な実装指示と期待結果を伝達

3. **コンテキスト管理**
    - プロジェクト全体の状態を把握
    - Sub Agent間の情報共有を調整
    - 作業履歴と決定事項を記録

**重要**: Primary Agentは直接コード生成を行わず、Sub Agentに実装を指示する

### Sub Agent
**Primary Agentの指示を受けて実際のコード実装を行う**

1. **実装タスク実行**
    - Primary Agentから受け取った実装指示を実行

2. **実装結果報告**
    - 生成したコードの概要を報告
    - 重要な設計決定を文書化
    - 他Agentへの申し送り事項を明記

## 実装指示の書き方

### ✅ 正しい指示（実装まで行われる）
```
"GitHub Issue #XXXの要件に従って、GET /rolesエンドポイントを実装してください。
実際にOpenAPI仕様ファイルを作成・編集してください。
`make ogen` を実行して、コード生成してください"
```

### ❌ 間違った指示（相談で終わる）
```
"GET /rolesエンドポイントの実装方法を教えてください。"
```

## 指示に必須の情報

**【タスク定義】**
- 目的: [何を実現したいか]
- 期待成果: [具体的な成果物]

**【現在のコンテキスト】**
- 関連ファイル: [既存のコードパス]
- 技術スタック: [使用する技術/ライブラリ]
- 制約事項: [守るべきルール]

**【完了条件】**
- 機能要件: [必須の機能]
- テスト基準: [動作確認方法]

## 具体的なワークフロー
```
1. 要求分析 → 2. 実装計画 → 3. Sub Agent実装指示 → 4. Sub Agent実装実行 → 5. 統合・確認 → 6. 完了報告
   [Primary]    [Primary]      [Primary]             [Sub Agent]         [Primary]      [Primary]
```

## Primary Agentの検証責務

**Sub Agent完了報告後の必須確認：**
```bash
git status      # ファイル変更確認
go build ./...  # ビルド確認
```

**実装の実体化確認なしに完了としない**

## 禁止事項

- Sub Agentへの曖昧な指示
- 実装確認なしでの完了宣言
- Primary Agentによる直接的なコード生成
